---

any(
  include('matrix-meta'),
  include('matrix')
)

---

matrix-meta:
  id: str()
  name: str()
  version: num()
  tactics: list(include('object-id'))
  data: list(include('data-source'))

matrix:
  id: str()
  name: str()
  version: num()
  tactics: list(include('tactic'))
  techniques: list(include('technique'))
  case-studies: list(include('technique'))

object-id: regex('([a-zA-Z]+\.)*([A-Z]+[0-9]{4})')

object-type: enum('tactic', 'technique', 'case-study')

technique:
  id: include('object-id')
  object-type: include('object-type')
  name: str()
  description: str()
  tactics: list(include('object-id'), required=False)
  subtechnique-of: include('object-id', required=False)

tactic:
  id: include('object-id')
  object-type: include('object-type')
  name: str()
  description: str()

case-study:
  id: str()
  object-type: str()
  name: str()
  summary: str()
  incident-date: day()
  date-granularity: enum('YEAR', 'MONTH', 'DATE')
  procedure: list(include('case-study-procedure'))
  reported-by: str()
  references: any(null(), list(include('reference')))

case-study-procedure:
  tactic: include('object-id')
  technique: include('object-id')
  description: str()

reference:
  title: any(null(), str())
  url: any(null(), str())
