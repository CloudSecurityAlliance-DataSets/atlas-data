---

any(
  list(
    include('case-study'),
  )
)

---

matrix:
  id: str()
  name: str()
  version: num()
  tactics: include('matrix-object')
  techniques: include('matrix-object')
  case-studies: include('matrix-object', required=False)
  external: list(include('matrix'), required=False)

matrix-object:
  prefix: str()
  format: enum('ADVML', 'STIX')
  data: str()

object-id: regex('([a-zA-Z]+\.)*([A-Z]+[0-9]{4})')

object-type: enum('tactic', 'technique', 'case-study')

technique:
  id: include('object-id')
  object-type: include('object-type')
  name: str()
  description: str()
  tactics: list(include('object-id'))
  subtechnique-of: include('object-id', required=False)

tactic:
  id: include('object-id')
  object-type: include('object-type')
  name: str()
  description: str()

case-study:
  id: str()
  object-type: str()
  name: str()
  summary: str()
  incident-date: str()
  procedure: list(include('case-study-procedure'))
  reported-by: str()
  verified-by: str()
  sources: list(str())

case-study-procedure:
  tactic: include('object-id')
  technique: include('object-id')
  description: str()
